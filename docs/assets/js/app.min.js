(()=>{var e={969:()=>{},379:e=>{"use strict";var t=[];function r(e){for(var r=-1,n=0;n<t.length;n++)if(t[n].identifier===e){r=n;break}return r}function n(e,n){for(var a={},s=[],o=0;o<e.length;o++){var c=e[o],l=n.base?c[0]+n.base:c[0],d=a[l]||0,u="".concat(l," ").concat(d);a[l]=d+1;var p=r(u),m={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==p)t[p].references++,t[p].updater(m);else{var h=i(m,n);n.byIndex=o,t.splice(o,0,{identifier:u,updater:h,references:1})}s.push(u)}return s}function i(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,i){var a=n(e=e||[],i=i||{});return function(e){e=e||[];for(var s=0;s<a.length;s++){var o=r(a[s]);t[o].references--}for(var c=n(e,i),l=0;l<a.length;l++){var d=r(a[l]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}a=c}}},569:e=>{"use strict";var t={};e.exports=function(e,r){var n=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,r)=>{"use strict";e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},795:e=>{"use strict";e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var i=void 0!==r.layer;i&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,i&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var a=r.sourceMap;a&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.nc=void 0,(()=>{"use strict";var e=r(379),t=r.n(e),n=r(795),i=r.n(n),a=r(569),s=r.n(a),o=r(565),c=r.n(o),l=r(216),d=r.n(l),u=r(589),p=r.n(u),m=r(969),h=r.n(m),g={};g.styleTagTransform=p(),g.setAttributes=c(),g.insert=s().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=d(),t()(h(),g),h()&&h().locals&&h().locals;class _{constructor(){this.baseArea=void 0,this.timersArea=void 0,this.timerCreatorInputTitle=void 0,this.historyArea=void 0}clearCreatorTimerTitle(){return this.timerCreatorInputTitle.value="",!0}removeTimer(e){const t=this.timersArea.querySelector(`[data-id="${e}"]`);t&&t.remove()}_generateElement(e,t,r={}){const n=document.createElement(e);switch(Array.isArray(t)?n.classList.add(...t):n.classList.add(t),e){case"input":switch(n.type=r.type??"text",r.name&&(n.name=r.name),r.disabled&&(n.disabled=!0),r.type){case"file":n.multiple=r.multiple??!1,n.accept=r.accept??!1;break;case"text":n.autocomplete=r.autocomplete??!1,n.placeholder=r.placeholder??!1;break;case"checkbox":case"radio":n.checked=r.checked??null}break;case"div":case"span":n.innerText=r.innerText??null;break;case"button":let e=!1;r.innerText&&(e=document.createElement("span")),n.type=r.type??"button",e&&(e.innerText=r.innerText,n.appendChild(e))}return n}_generateSettingsCheckbox(e,t,r){const n=this._generateElement("label","settings__item"),i=this._generateElement("input","settings__item-input",{type:"checkbox",name:`settings-${e}`,checked:r}),a=this._generateElement("span","settings__item-text",{innerText:t});return n.appendChild(i),n.appendChild(a),n}renderBaseDOM(e){const t=this._generateElement("div","timersArea"),r=this._generateElement("div","creator"),n=this._generateElement("input","creator__title",{type:"text",autocomplete:"off",placeholder:"Название таймера"}),i=this._generateElement("button",["creator__btn-create","btn","btn_text-icon"],{innerText:"Создать"}),a=this._generateElement("div","timers"),s=this._generateElement("button",["creator__btn-export","btn","btn_text-icon"],{innerText:"Выгрузить"}),o=this._generateElement("button",["creator__btn-import","btn","btn_text-icon"],{innerText:"Загрузить"}),c=this._generateElement("input","creator__file",{type:"file",multiple:!1,accept:".json"}),l=this._generateElement("button",["creator__btn-settings","btn","btn_icon"]),d=this._generateElement("div","settings"),u=this._generateElement("div","settings__grid"),p=this._generateElement("button",["creator__btn-history","btn","btn_text-icon"],{innerText:"История"}),m=this._generateElement("div",["history"]);this.baseArea=t,n.dataset.area="creator-title-input",this.timerCreatorInputTitle=n,this.timersArea=a,this.historyArea=m;const h=[this._generateSettingsCheckbox("autostop","Останавливать при добавлении нового",!1),this._generateSettingsCheckbox("stopOnReload","Останавливать при перезагрузке страницы",!0),this._generateSettingsCheckbox("oneplay","Только один активный",!1),this._generateSettingsCheckbox("replaceImport","Заменять при импорте",!1)];return h.forEach((e=>{u.appendChild(e)})),[n,i,s,o,c,p,l].forEach((e=>{r.appendChild(e)})),d.appendChild(u),[r,d,a,m].forEach((e=>{t.appendChild(e)})),document.body.appendChild(t),{baseArea:t,timerCreatorArea:r,timerCreatorInputTitle:n,timerCreatorButton:i,exportButton:s,importButton:o,importInput:c,settingsArea:d,settingsAutostop:h[0],settingsStopOnReload:h[1],settingsOnePlay:h[2],settingsReplaceImport:h[3],settingsButton:l,historyButton:p,historyArea:m,timersArea:a}}renderTimerDOM(e,t){const r=this._generateElement("div","timer"),n=this._generateElement("input","timer__title-input"),i=this.timerCreatorInputTitle.value.trim(),a=this._generateElement("div","timer__result",{innerText:"00:00:00 — 0.00"}),s=this._generateElement("div",["timer__button","timer__button_playpause","timer__button_playpause-paused"]),o=this._generateElement("div",["timer__button","timer__button_remove"]),c=this._generateElement("div",["timer__button","timer__button_restart"]);return r.dataset.id=e,n.value=i.length?i:t.defaultTitle?t.defaultTitle:"Untitled",[n,s,a,c,o].forEach((e=>{r.appendChild(e)})),this.timersArea.appendChild(r),this.clearCreatorTimerTitle(),{timerArea:r,timerTitleInput:n,timerPlayPause:s,timerResult:a,timerRestart:c,timerRemove:o}}addHistoryItem(e){const t=this._generateElement("div",["history__item"]);t.insertAdjacentHTML("afterbegin",e),this.historyArea.insertAdjacentHTML("afterbegin",t)}}class v{#e=!1;#t=!1;#r=0;#n=void 0;#i=void 0;constructor(e,t){if(t){const e=Date.now();this.#e=!0,this.#n=e,this.#t=e-t}this.#i=e||"Undefined"}#a(e){e=Math.floor(e/1e3);let t=Math.floor(e/3600);e%=3600;let r=Math.floor(e/60),n=(t+r/60).toFixed(2),i=e%60;return t<10&&(t=`0${t}`),r<10&&(r=`0${r}`),i<10&&(i=`0${i}`),`${t}:${r}:${i} — ${n}`}get durationSeconds(){const e=Date.now();return this.#e&&!this.#n?e-this.#t-this.#r:this.#e?e-this.#t-(e-this.#n+this.#r):0}get getTime(){return!(!this.#e||this.#n)&&this.#a(Date.now()-this.#t-this.#r)}get getTitle(){return this.#i}get timeForReload(){return this.#a(Date.now()-this.#t-this.#r)}get isPaused(){return!!this.#n}get timerData(){return{activated:this.#e,started:this.#t,paused:this.#r,pauseStarted:this.#n,title:this.#i}}set title(e){this.#i=e}pause(){const e=Date.now();this.#e&&!this.#n&&(this.#n=e)}playPause(){const e=Date.now();this.#e?this.#n?(this.#r+=e-this.#n,this.#n=void 0):this.#n=e:(this.#e=!0,this.#t=e)}restart(){this.#e=!1,this.#t=!1,this.#r=0,this.#n=void 0}}class y{constructor(e){this.historyArea=e,this.ui=new _}add(e){const t=this.ui._generateElement("div",["history__item"]),r=this.ui._generateElement("span",["history__item-date"]),n=this.ui._generateElement("span",["history__item-text"]),i=this.ui._generateElement("span","history__item-dot"),a=new Date(Date.now());let s=a.getDate(),o=a.getMonth()+1,c=a.getFullYear(),l=a.getHours(),d=a.getMinutes(),u=a.getSeconds();o<10&&(o=`0${o}`),l<10&&(l=`0${l}`),d<10&&(d=`0${d}`),u<10&&(u=`0${u}`),r.innerHTML=`${s}.${o}.${c} &bull; ${l}:${d}:${u}`,n.innerHTML=e,t.appendChild(i),t.appendChild(r),t.appendChild(n),this.historyArea.insertAdjacentElement("afterbegin",t)}}const f=new _,b=new Map,E=new class{get data(){return localStorage.getItem("timers")??!1}get available(){let e;try{e=window.localStorage;let t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&e&&0!==e.length}}save(e){const t=JSON.stringify(e);localStorage.setItem("timers",t)}},S=new class{get data(){return localStorage.getItem("settings")??!1}get available(){let e;try{e=window.localStorage;let t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&e&&0!==e.length}}save(e){const t=JSON.stringify(e);localStorage.setItem("settings",t)}};let T,x,k=0;const A=E.available,C=()=>{const e=f.renderTimerDOM(k,{}),t=new v(e.timerTitleInput.value),r=x.settingsAutostop.querySelector("input").checked;if(b.set(k,{timerDOM:e,controls:t}),e.timerPlayPause.addEventListener("click",R.bind(void 0,t,e)),e.timerRestart.addEventListener("click",I.bind(void 0,t,e)),e.timerRemove.addEventListener("click",w.bind(void 0,k)),e.timerTitleInput.addEventListener("keyup",O.bind(void 0,t,e)),r){for(const e of b.keys()){const t=b.get(e);t.controls.pause(),t.timerDOM.timerPlayPause.classList.add("timer__button_playpause-paused")}T.add("Таймеры остановлены после добавления нового")}k++},O=(e,t,r)=>{const n=r.target.value.trim();n.length>0&&(e.title=n,M())},I=(e,t)=>{confirm("Вы уверены, что хотите перезапустить таймер?")&&(e.restart(),e.isPaused||t.timerPlayPause.classList.add("timer__button_playpause-paused"),t.timerResult.innerText="00:00:00 — 0.00")},R=(e,t)=>{e.playPause(),e.isPaused?(t.timerPlayPause.classList.add("timer__button_playpause-paused"),T.add(`Таймер <strong>&laquo;${e.getTitle}&raquo;</strong> остановлен`)):(t.timerPlayPause.classList.remove("timer__button_playpause-paused"),T.add(`Таймер <strong>&laquo;${e.getTitle}&raquo;</strong> запущен`))},w=(e,t=!1)=>{confirm("Вы уверены, что хотите удалить таймер?")&&(b.delete(e),f.removeTimer(e))},M=(e=!1)=>{if(A){const t=[];for(const e of b.keys()){const r=b.get(e),n={duration:r.controls.durationSeconds,title:r.controls.timerData.title};t.push(n)}if(e)return t;E.save(t)}return!1},L=e=>{const t=x.settingsReplaceImport.querySelector("input").checked;try{if(t)for(const e of b.keys())b.delete(e),f.removeTimer(e);e.forEach(((e,t)=>{const r=f.renderTimerDOM(t,{defaultTitle:e.title}),n=new v(e.title,e.duration);b.set(k,{timerDOM:r,controls:n}),r.timerPlayPause.addEventListener("click",R.bind(void 0,n,r)),r.timerRestart.addEventListener("click",I.bind(void 0,n,r)),r.timerRemove.addEventListener("click",w.bind(void 0,t)),r.timerTitleInput.addEventListener("keyup",O.bind(void 0,n,r));const i=n.timeForReload.length>18?"00:00:00 — 0.00":n.timeForReload;r.timerResult.innerText=i,T.add(`Таймер <strong>&laquo;${e.title}&raquo;</strong> восстановлен из резервной копии с значением <nobr>${i}</nobr>`),k++})),T.add("Таймеры восстановлены из локального хранилища")}catch(e){throw new Error(e)}},D=e=>{const t=e.target;if(1===t.files.length){const e=t.files[0],r=new FileReader;r.readAsText(e),r.onload=function(){const e=JSON.parse(r.result);e.length>0&&L(e)},t.value=""}},P=()=>{const e=M(!0);if(e.length>0){const t=JSON.stringify(e),r="data:application/json;charset=utf-8,"+encodeURIComponent(t),n=new Date;let i="data_timers.json",a=n.getFullYear(),s=n.getMonth()+1,o=n.getDate();s<10&&(s=`0${s}`),o<10&&(o=`0${o}`),i=`${o}.${s}.${a}-${i}`;const c=document.createElement("a");c.setAttribute("href",r),c.setAttribute("download",i),c.click()}};document.addEventListener("DOMContentLoaded",(()=>{const e=f.renderBaseDOM();if(x=e,T=new y(x.historyArea),document.addEventListener("keypress",(e=>{const t=e.target;"Enter"===e.key&&"creator-title-input"===t.dataset.area&&t.value.length>0&&C()})),A){const e=JSON.parse(E.data);e.length>0&&L(e);const t=JSON.parse(S.data);t&&(e=>{try{console.log(e),e.autoStop?x.settingsAutostop.querySelector("input").checked=!0:x.settingsAutostop.querySelector("input").checked=!1,e.stopOnReload?x.settingsStopOnReload.querySelector("input").checked=!0:x.settingsStopOnReload.querySelector("input").checked=!1,e.onePlay?x.settingsOnePlay.querySelector("input").checked=!0:x.settingsOnePlay.querySelector("input").checked=!1,e.replaceImport?x.settingsReplaceImport.querySelector("input").checked=!0:x.settingsReplaceImport.querySelector("input").checked=!1}catch(e){throw new Error(e)}})(t)}e.importButton.addEventListener("click",(()=>{e.importInput.click()})),e.timerCreatorButton.addEventListener("click",C),e.exportButton.addEventListener("click",P),e.importInput.addEventListener("change",D),e.settingsButton.addEventListener("click",(()=>{e.settingsArea.classList.toggle("settings-active"),e.settingsButton.classList.toggle("creator__btn-settings_active")})),setInterval((()=>{for(const e of b.keys()){const t=b.get(e),r=t.controls.getTime;r&&(t.timerDOM.timerResult.innerText=r)}M(),(()=>{const e={autoStop:x.settingsAutostop.querySelector("input").checked,stopOnReload:x.settingsStopOnReload.querySelector("input").checked,onePlay:x.settingsOnePlay.querySelector("input").checked,replaceImport:x.settingsReplaceImport.querySelector("input").checked};S.save(e)})()}),1e3)}))})()})();
//# sourceMappingURL=app.min.js.map