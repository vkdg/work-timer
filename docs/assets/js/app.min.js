(()=>{var e={969:()=>{},379:e=>{"use strict";var t=[];function r(e){for(var r=-1,s=0;s<t.length;s++)if(t[s].identifier===e){r=s;break}return r}function s(e,s){for(var i={},n=[],o=0;o<e.length;o++){var l=e[o],d=s.base?l[0]+s.base:l[0],u=i[d]||0,c="".concat(d," ").concat(u);i[d]=u+1;var p=r(c),m={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)t[p].references++,t[p].updater(m);else{var h=a(m,s);s.byIndex=o,t.splice(o,0,{identifier:c,updater:h,references:1})}n.push(c)}return n}function a(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,a){var i=s(e=e||[],a=a||{});return function(e){e=e||[];for(var n=0;n<i.length;n++){var o=r(i[n]);t[o].references--}for(var l=s(e,a),d=0;d<i.length;d++){var u=r(i[d]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}i=l}}},569:e=>{"use strict";var t={};e.exports=function(e,r){var s=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(r)}},216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,r)=>{"use strict";e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},795:e=>{"use strict";e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var s="";r.supports&&(s+="@supports (".concat(r.supports,") {")),r.media&&(s+="@media ".concat(r.media," {"));var a=void 0!==r.layer;a&&(s+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),s+=r.css,a&&(s+="}"),r.media&&(s+="}"),r.supports&&(s+="}");var i=r.sourceMap;i&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(s,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function r(s){var a=t[s];if(void 0!==a)return a.exports;var i=t[s]={exports:{}};return e[s](i,i.exports,r),i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.nc=void 0,(()=>{"use strict";var e=r(379),t=r.n(e),s=r(795),a=r.n(s),i=r(569),n=r.n(i),o=r(565),l=r.n(o),d=r(216),u=r.n(d),c=r(589),p=r.n(c),m=r(969),h=r.n(m),v={};v.styleTagTransform=p(),v.setAttributes=l(),v.insert=n().bind(null,"head"),v.domAPI=a(),v.insertStyleElement=u(),t()(h(),v),h()&&h().locals&&h().locals;class _{#e=!1;#t=!1;#r=0;#s=void 0;#a=void 0;constructor(e,t){if(t){const e=Date.now();this.#e=!0,this.#s=e,this.#t=e-t}this.#a=e||"Undefined"}#i(e){e=Math.floor(e/1e3);let t=Math.floor(e/3600);e%=3600;let r=Math.floor(e/60),s=(t+r/60).toFixed(2),a=e%60;return t<10&&(t=`0${t}`),r<10&&(r=`0${r}`),a<10&&(a=`0${a}`),`${t}:${r}:${a} — ${s}`}get durationSeconds(){const e=Date.now();return this.#e&&!this.#s?e-this.#t-this.#r:this.#e?e-this.#t-(e-this.#s+this.#r):0}get getTime(){return!(!this.#e||this.#s)&&this.#i(Date.now()-this.#t-this.#r)}get timeForReload(){return this.#i(Date.now()-this.#t-this.#r)}get isPaused(){return!!this.#s}get timerData(){return{activated:this.#e,started:this.#t,paused:this.#r,pauseStarted:this.#s,title:this.#a}}set title(e){this.#a=e}playPause(){const e=Date.now();this.#e?this.#s?(this.#r+=e-this.#s,this.#s=void 0):this.#s=e:(this.#e=!0,this.#t=e)}restart(){this.#e=!1,this.#t=!1,this.#r=0,this.#s=void 0}}const g=new class{constructor(){this.baseArea=void 0,this.timersArea=void 0,this.timerCreatorInputTitle=void 0}clearCreatorTimerTitle(){return this.timerCreatorInputTitle.value="",!0}removeTimer(e){const t=this.timersArea.querySelector(`[data-id="${e}"]`);t&&t.remove()}_generateElement(e,t,r){const s=document.createElement(e);return Array.isArray(t)?s.classList.add(...t):s.classList.add(t),s}_generateSettingsCheckbox(e,t,r){const s=document.createElement("label"),a=document.createElement("input"),i=document.createElement("span");return s.classList.add("settings__item"),a.classList.add("settings__item-input"),a.type="checkbox",a.name=`settings-${e}`,r&&(a.checked=!0),i.classList.add("settings__item-text"),i.innerText=t,s.appendChild(a),s.appendChild(i),s}renderBaseDOM(e){const t=this._generateElement("div","timersArea"),r=this._generateElement("div","creator"),s=this._generateElement("input","creator__title"),a=this._generateElement("button",["creator__button","creator__button-create"]),i=this._generateElement("div","timers"),n=this._generateElement("button",["creator__button","creator__button-export"]),o=this._generateElement("button",["creator__button","creator__button-import"]),l=this._generateElement("input","creator__file"),d=this._generateElement("button",["creator__button","creator__button-settings"]),u=this._generateElement("div","settings"),c=this._generateElement("div","settings__grid");return this.baseArea=t,s.placeholder=e.creator.inputPlaceholder||'Имя таймера (по умолчанию "Untitled")',s.autocomplete="off",s.dataset.area="creator-title-input",this.timerCreatorInputTitle=s,l.type="file",l.multiple=!1,l.accept=".json",this.timersArea=i,[this._generateSettingsCheckbox("autostop","Останавливать таймеры при добавлении нового",!1),this._generateSettingsCheckbox("oneplay","Только один активный таймер",!1),this._generateSettingsCheckbox("replaceImport","Заменять таймеры при импорте",!1)].forEach((e=>{c.appendChild(e)})),[s,a,n,o,l,d].forEach((e=>{r.appendChild(e)})),u.appendChild(c),[r,u,i].forEach((e=>{t.appendChild(e)})),document.body.appendChild(t),{baseArea:t,timerCreatorArea:r,timerCreatorInputTitle:s,timerCreatorButton:a,exportButton:n,importButton:o,importInput:l,settingsArea:u,settingsButton:d,timersArea:i}}renderTimerDOM(e,t){const r=this._generateElement("div","timer"),s=this._generateElement("div","timer__title"),a=this._generateElement("input","timer__title-input"),i=this.timerCreatorInputTitle.value.trim(),n=this._generateElement("div","timer__result"),o=this._generateElement("div",["timer__button","timer__button_playpause","timer__button_playpause-paused"]),l=this._generateElement("div",["timer__button","timer__button_remove"]),d=this._generateElement("div",["timer__button","timer__button_restart"]);return r.dataset.id=e,n.innerText="00:00:00 — 0.00",a.value=i.length?i:t.defaultTitle?t.defaultTitle:"Untitled",s.innerText=i.length?i:t.defaultTitle?t.defaultTitle:"Untitled",[a,s,o,n,d,l].forEach((e=>{r.appendChild(e)})),this.timersArea.appendChild(r),this.clearCreatorTimerTitle(),{timerArea:r,timerTitleInput:a,timerTitle:s,timerResult:n,timerPlayPause:o,timerRemove:l,timerRestart:d}}renderTimersHistoryDOM(e,t){const r=document.createElement("div");return r.classList.add("history"),e.appendChild(r),r}},f=new Map,b=new class{get data(){return localStorage.getItem("timers")??!1}get available(){let e;try{e=window.localStorage;let t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&e&&0!==e.length}}save(e){const t=JSON.stringify(e);localStorage.setItem("timers",t)}};let E=0;const y=b.available,C=()=>{const e=g.renderTimerDOM(E,{areaClasses:!1,titleInputClasses:!1,titleClasses:!1,defaultTitle:!1,resultClasses:!1,playPauseClasses:!1,removeClasses:!1,restartClasses:!1}),t=new _(e.timerTitleInput.value);f.set(E,{timerDOM:e,controls:t}),e.timerPlayPause.addEventListener("click",x.bind(void 0,t,e)),e.timerRestart.addEventListener("click",S.bind(void 0,t,e)),e.timerRemove.addEventListener("click",L.bind(void 0,E)),e.timerTitleInput.addEventListener("keyup",T.bind(void 0,t,e)),E++},T=(e,t,r)=>{const s=r.target.value.trim();s.length>0&&(e.title=s,I())},S=(e,t)=>{e.restart(),e.isPaused||t.timerPlayPause.classList.add("timer__button_playpause-paused"),t.timerResult.innerText="00:00:00 — 0.00"},x=(e,t)=>{e.playPause(),e.isPaused?t.timerPlayPause.classList.add("timer__button_playpause-paused"):t.timerPlayPause.classList.remove("timer__button_playpause-paused")},L=e=>{f.delete(e),g.removeTimer(e)},I=(e=!1)=>{if(y){const t=[];for(const e of f.keys()){const r=f.get(e),s={duration:r.controls.durationSeconds,title:r.controls.timerData.title};t.push(s)}if(e)return t;b.save(t)}return!1},k=e=>{try{e.forEach(((e,t)=>{const r=g.renderTimerDOM(t,{areaClasses:!1,titleInputClasses:!1,titleClasses:!1,defaultTitle:e.title,resultClasses:!1,playPauseClasses:!1,removeClasses:!1,restartClasses:!1}),s=new _(e.title,e.duration);f.set(t,{timerDOM:r,controls:s}),r.timerPlayPause.addEventListener("click",x.bind(void 0,s,r)),r.timerRestart.addEventListener("click",S.bind(void 0,s,r)),r.timerRemove.addEventListener("click",L.bind(void 0,t)),r.timerTitleInput.addEventListener("keyup",T.bind(void 0,s,r)),r.timerResult.innerText=s.timeForReload.length>18?"00:00:00 — 0.00":s.timeForReload,E++}))}catch(e){throw new Error(e)}},A=e=>{const t=e.target;if(1===t.files.length){const e=t.files[0],r=new FileReader;r.readAsText(e),r.onload=function(){const e=JSON.parse(r.result);e.length>0&&k(e)}}},M=()=>{const e=I(!0);if(e.length>0){const t=JSON.stringify(e),r="data:application/json;charset=utf-8,"+encodeURIComponent(t),s=new Date;let a="data_timers.json",i=s.getFullYear(),n=s.getMonth()+1,o=s.getDate();n<10&&(n=`0${n}`),o<10&&(o=`0${o}`),a=`${o}.${n}.${i}-${a}`;const l=document.createElement("a");l.setAttribute("href",r),l.setAttribute("download",a),l.click()}};document.addEventListener("DOMContentLoaded",(()=>{const e=g.renderBaseDOM({base:{areaClasses:!1},creator:{areaClasses:!1,inputClasses:!1,inputPlaceholder:"Название таймера",buttonClasses:!1,buttonText:!1,importButtonClasses:!1,exportButtonClasses:!1}});if(document.addEventListener("keypress",(e=>{const t=e.target;"Enter"===e.key&&"creator-title-input"===t.dataset.area&&t.value.length>0&&C()})),y){const e=JSON.parse(b.data);e.length>0&&k(e)}e.importButton.addEventListener("click",(()=>{e.importInput.click()})),e.timerCreatorButton.addEventListener("click",C),e.exportButton.addEventListener("click",M),e.importInput.addEventListener("change",A),e.settingsButton.addEventListener("click",(()=>{e.settingsArea.classList.toggle("settings-active"),e.settingsButton.classList.toggle("creator__button-settings_active")})),setInterval((()=>{for(const e of f.keys()){const t=f.get(e),r=t.controls.getTime;r&&(t.timerDOM.timerResult.innerText=r)}I()}),1e3)}))})()})();
//# sourceMappingURL=app.min.js.map