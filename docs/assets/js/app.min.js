(()=>{var e={969:()=>{},379:e=>{"use strict";var t=[];function r(e){for(var r=-1,a=0;a<t.length;a++)if(t[a].identifier===e){r=a;break}return r}function a(e,a){for(var i={},n=[],o=0;o<e.length;o++){var l=e[o],d=a.base?l[0]+a.base:l[0],c=i[d]||0,u="".concat(d," ").concat(c);i[d]=c+1;var p=r(u),m={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)t[p].references++,t[p].updater(m);else{var h=s(m,a);a.byIndex=o,t.splice(o,0,{identifier:u,updater:h,references:1})}n.push(u)}return n}function s(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,s){var i=a(e=e||[],s=s||{});return function(e){e=e||[];for(var n=0;n<i.length;n++){var o=r(i[n]);t[o].references--}for(var l=a(e,s),d=0;d<i.length;d++){var c=r(i[d]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}i=l}}},569:e=>{"use strict";var t={};e.exports=function(e,r){var a=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(r)}},216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,r)=>{"use strict";e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},795:e=>{"use strict";e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var a="";r.supports&&(a+="@supports (".concat(r.supports,") {")),r.media&&(a+="@media ".concat(r.media," {"));var s=void 0!==r.layer;s&&(a+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),a+=r.css,s&&(a+="}"),r.media&&(a+="}"),r.supports&&(a+="}");var i=r.sourceMap;i&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(a,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function r(a){var s=t[a];if(void 0!==s)return s.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,r),i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.nc=void 0,(()=>{"use strict";var e=r(379),t=r.n(e),a=r(795),s=r.n(a),i=r(569),n=r.n(i),o=r(565),l=r.n(o),d=r(216),c=r.n(d),u=r(589),p=r.n(u),m=r(969),h=r.n(m),v={};v.styleTagTransform=p(),v.setAttributes=l(),v.insert=n().bind(null,"head"),v.domAPI=s(),v.insertStyleElement=c(),t()(h(),v),h()&&h().locals&&h().locals;class _{#e=!1;#t=!1;#r=0;#a=void 0;#s=void 0;constructor(e,t){if(t){const e=Date.now();this.#e=!0,this.#a=e,this.#t=e-t}this.#s=e||"Undefined"}#i(e){e=Math.floor(e/1e3);let t=Math.floor(e/3600);e%=3600;let r=Math.floor(e/60),a=(t+r/60).toFixed(2),s=e%60;return t<10&&(t=`0${t}`),r<10&&(r=`0${r}`),s<10&&(s=`0${s}`),`${t}:${r}:${s} — ${a}`}get durationSeconds(){const e=Date.now();return this.#e&&!this.#a?e-this.#t-this.#r:this.#e?e-this.#t-(e-this.#a+this.#r):0}get getTime(){return!(!this.#e||this.#a)&&this.#i(Date.now()-this.#t-this.#r)}get timeForReload(){return this.#i(Date.now()-this.#t-this.#r)}get isPaused(){return!!this.#a}get timerData(){return{activated:this.#e,started:this.#t,paused:this.#r,pauseStarted:this.#a,title:this.#s}}set title(e){this.#s=e}playPause(){const e=Date.now();this.#e?this.#a?(this.#r+=e-this.#a,this.#a=void 0):this.#a=e:(this.#e=!0,this.#t=e)}restart(){this.#e=!1,this.#t=!1,this.#r=0,this.#a=void 0}}const g=new class{constructor(){this.baseArea=void 0,this.timersArea=void 0,this.timerCreatorInputTitle=void 0}clearCreatorTimerTitle(){return this.timerCreatorInputTitle.value="",!0}removeTimer(e){const t=this.timersArea.querySelector(`[data-id="${e}"]`);t&&t.remove()}_generateElement(e,t,r={}){const a=document.createElement(e);switch(Array.isArray(t)?a.classList.add(...t):a.classList.add(t),e){case"input":switch(a.type=r.type??"text",r.name&&(a.name=r.name),r.disabled&&(a.disabled=!0),r.type){case"file":a.multiple=r.multiple??!1,a.accept=r.accept??!1;break;case"text":a.autocomplete=r.autocomplete??!1,a.placeholder=r.placeholder??!1;break;case"checkbox":case"radio":a.checked=r.checked??null}break;case"div":case"span":a.innerText=r.innerText??null;break;case"button":a.type=r.type??"button",a.innerText=r.innerText??null}return a}_generateSettingsCheckbox(e,t,r){const a=this._generateElement("label","settings__item"),s=this._generateElement("input","settings__item-input",{type:"checkbox",name:`settings-${e}`,checked:r}),i=this._generateElement("span","settings__item-text",{innerText:t});return a.appendChild(s),a.appendChild(i),a}renderBaseDOM(e){const t=this._generateElement("div","timersArea"),r=this._generateElement("div","creator"),a=this._generateElement("input","creator__title",{type:"text",autocomplete:"off",placeholder:"Название таймера"}),s=this._generateElement("button",["creator__button","creator__button-create","creator__button-with-icon"],{innerText:"Создать"}),i=this._generateElement("div","timers"),n=this._generateElement("button",["creator__button","creator__button-export","creator__button-with-icon"],{innerText:"Выгрузить"}),o=this._generateElement("button",["creator__button","creator__button-import","creator__button-with-icon"],{innerText:"Загрузить"}),l=this._generateElement("input","creator__file",{type:"file",multiple:!1,accept:".json"}),d=this._generateElement("button",["creator__button","creator__button-settings"]),c=this._generateElement("div","settings"),u=this._generateElement("div","settings__grid");return this.baseArea=t,a.dataset.area="creator-title-input",this.timerCreatorInputTitle=a,this.timersArea=i,[this._generateSettingsCheckbox("autostop","Останавливать при добавлении нового",!1),this._generateSettingsCheckbox("stopOnReload","Останавливать при перезагрузке страницы",!0),this._generateSettingsCheckbox("oneplay","Только один активный",!1),this._generateSettingsCheckbox("replaceImport","Заменять при импорте",!1)].forEach((e=>{u.appendChild(e)})),[a,s,n,o,l,d].forEach((e=>{r.appendChild(e)})),c.appendChild(u),[r,c,i].forEach((e=>{t.appendChild(e)})),document.body.appendChild(t),{baseArea:t,timerCreatorArea:r,timerCreatorInputTitle:a,timerCreatorButton:s,exportButton:n,importButton:o,importInput:l,settingsArea:c,settingsButton:d,timersArea:i}}renderTimerDOM(e,t){const r=this._generateElement("div","timer"),a=this._generateElement("input","timer__title-input"),s=this.timerCreatorInputTitle.value.trim(),i=this._generateElement("div","timer__result",{innerText:"00:00:00 — 0.00"}),n=this._generateElement("div",["timer__button","timer__button_playpause","timer__button_playpause-paused"]),o=this._generateElement("div",["timer__button","timer__button_remove"]),l=this._generateElement("div",["timer__button","timer__button_restart"]);return r.dataset.id=e,a.value=s.length?s:t.defaultTitle?t.defaultTitle:"Untitled",[a,n,i,l,o].forEach((e=>{r.appendChild(e)})),this.timersArea.appendChild(r),this.clearCreatorTimerTitle(),{timerArea:r,timerTitleInput:a,timerPlayPause:n,timerResult:i,timerRestart:l,timerRemove:o}}renderTimersHistoryDOM(e,t){const r=document.createElement("div");return r.classList.add("history"),e.appendChild(r),r}},f=new Map,b=new class{get data(){return localStorage.getItem("timers")??!1}get available(){let e;try{e=window.localStorage;let t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&e&&0!==e.length}}save(e){const t=JSON.stringify(e);localStorage.setItem("timers",t)}};let y=0;const E=b.available,C=()=>{const e=g.renderTimerDOM(y,{areaClasses:!1,titleInputClasses:!1,titleClasses:!1,defaultTitle:!1,resultClasses:!1,playPauseClasses:!1,removeClasses:!1,restartClasses:!1}),t=new _(e.timerTitleInput.value);f.set(y,{timerDOM:e,controls:t}),e.timerPlayPause.addEventListener("click",S.bind(void 0,t,e)),e.timerRestart.addEventListener("click",x.bind(void 0,t,e)),e.timerRemove.addEventListener("click",k.bind(void 0,y)),e.timerTitleInput.addEventListener("keyup",T.bind(void 0,t,e)),y++},T=(e,t,r)=>{const a=r.target.value.trim();a.length>0&&(e.title=a,w())},x=(e,t)=>{confirm("Вы уверены, что хотите перезапустить таймер?")&&(e.restart(),e.isPaused||t.timerPlayPause.classList.add("timer__button_playpause-paused"),t.timerResult.innerText="00:00:00 — 0.00")},S=(e,t)=>{e.playPause(),e.isPaused?t.timerPlayPause.classList.add("timer__button_playpause-paused"):t.timerPlayPause.classList.remove("timer__button_playpause-paused")},k=e=>{confirm("Вы уверены, что хотите удалить таймер?")&&(f.delete(e),g.removeTimer(e))},w=(e=!1)=>{if(E){const t=[];for(const e of f.keys()){const r=f.get(e),a={duration:r.controls.durationSeconds,title:r.controls.timerData.title};t.push(a)}if(e)return t;b.save(t)}return!1},I=e=>{try{e.forEach(((e,t)=>{const r=g.renderTimerDOM(t,{areaClasses:!1,titleInputClasses:!1,titleClasses:!1,defaultTitle:e.title,resultClasses:!1,playPauseClasses:!1,removeClasses:!1,restartClasses:!1}),a=new _(e.title,e.duration);f.set(t,{timerDOM:r,controls:a}),r.timerPlayPause.addEventListener("click",S.bind(void 0,a,r)),r.timerRestart.addEventListener("click",x.bind(void 0,a,r)),r.timerRemove.addEventListener("click",k.bind(void 0,t)),r.timerTitleInput.addEventListener("keyup",T.bind(void 0,a,r)),r.timerResult.innerText=a.timeForReload.length>18?"00:00:00 — 0.00":a.timeForReload,y++}))}catch(e){throw new Error(e)}},L=e=>{const t=e.target;if(1===t.files.length){const e=t.files[0],r=new FileReader;r.readAsText(e),r.onload=function(){const e=JSON.parse(r.result);e.length>0&&I(e)}}},A=()=>{const e=w(!0);if(e.length>0){const t=JSON.stringify(e),r="data:application/json;charset=utf-8,"+encodeURIComponent(t),a=new Date;let s="data_timers.json",i=a.getFullYear(),n=a.getMonth()+1,o=a.getDate();n<10&&(n=`0${n}`),o<10&&(o=`0${o}`),s=`${o}.${n}.${i}-${s}`;const l=document.createElement("a");l.setAttribute("href",r),l.setAttribute("download",s),l.click()}};document.addEventListener("DOMContentLoaded",(()=>{const e=g.renderBaseDOM({base:{areaClasses:!1},creator:{areaClasses:!1,inputClasses:!1,inputPlaceholder:"Название таймера",buttonClasses:!1,buttonText:!1,importButtonClasses:!1,exportButtonClasses:!1}});if(document.addEventListener("keypress",(e=>{const t=e.target;"Enter"===e.key&&"creator-title-input"===t.dataset.area&&t.value.length>0&&C()})),E){const e=JSON.parse(b.data);e.length>0&&I(e)}e.importButton.addEventListener("click",(()=>{e.importInput.click()})),e.timerCreatorButton.addEventListener("click",C),e.exportButton.addEventListener("click",A),e.importInput.addEventListener("change",L),e.settingsButton.addEventListener("click",(()=>{e.settingsArea.classList.toggle("settings-active"),e.settingsButton.classList.toggle("creator__button-settings_active")})),setInterval((()=>{for(const e of f.keys()){const t=f.get(e),r=t.controls.getTime;r&&(t.timerDOM.timerResult.innerText=r)}w()}),1e3)}))})()})();
//# sourceMappingURL=app.min.js.map